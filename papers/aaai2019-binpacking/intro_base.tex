\section{Introduction}
\label{sec:intro}

The three-dimensional bin packing problem (3D BPP) is a classical combinatorial optimization problem that directly models many industrial applications in logistic and production fields, i.e., container and pallet loading, cargo and warehouse management. %During last decades, both exact and heuristic algorithms for this problem have been extensively studied.
According to the typology for cutting and packing problems proposed by \cite{wascher2007improved}, the closest study to our problem is the 3D BPP, in which a number of cuboid-shaped items with different sizes should be packed into a set of homogeneous or heterogeneous bins orthogonally. The objective is usually to minimize the total cost ,i.e., the number of bins or the sum cost of selected heterogeneous bins. The 3D BPP is strongly NP-hard \cite{martello2000three} and in the last three decades, the 3D BPP and its variations have led to extensive studies in the field of operational research. %One variation of the problem is referred to as open dimension problem (ODP), where a single variable dimension occurs in packing planning\cite{miyazawa1997algorithm}
While exact algorithm can find optimal solution, it usually needs huge amount of time to solve even just small size instances. Heuristic algorithm ,which cannot guarantee optimal, is capable to give acceptable solutions with much less computational effort. 
%Exact methods provide the optimal solution but time consuming, whereas the heuristic methods run in limited time and return an acceptable solution. 
To design an efficient and effective algorithm for 3D BPP could potentially brings significant operation cost reduction in many real-world applications.

%The bin packing problem addressed in this paper is a specific variant of 3D-BPP in which the bin used to pack items can be infinity, that is, items can be packed into a single large enough bin.
In this paper, we study a specific variant of the classical 3D BPP, which to seek the best way of packing a given set of cuboid-shaped items into a flexible rectangular bin in such a way that the surface area of the bin is minimized. This new type 3D BPP arise from a real-wold business scenario. With the vigorous development of e-commerce, related logistic costs have attracted more and more attention, which are equal to about 15\% of Chinas GDP. Reducing logistic costs is often the number one priority for a businessesâ€™ bottom line. %There are many methods that can help improve supply chain processes and in turn save a business money. Methods of reducing logistic costs can range from optimizing inventory levels, to re-charting better shipping networks, to creating better processes, to improving supplier/third party relationships and so on.
Tens of millions of packages are sent to customers every day, 5\% of the which are prepared using plastic wrappers. Consequently, the companies prefer to pack the items in a way that minimize the surface area of the stack to reduce the cost of packing materials. We formalize this scenario into a new variation of 3D BPP and combine a learning based method with heuristic algorithms to efficiently and effectively solve the problem. 

%so it is a very popular research direction in optimization area. In addition, BPPs have numerous relevant industrial applications. An effective bin packing algorithm means the reduction of computation time, total packing cost and increase in utilization of resources.

%The cost of packing materials is mainly determined by their surface area and this occupies the most part of packing cost. In many real business scenarios such as e-commerce, bins with variable sizes, e.g., PE bag which is made of flexible and soft packing materials, are used to pack items. In this case, our research is engaged in a new type of 3D BPP, of which the objective is to pack all items into a bin with least surface area. 

Typically, to achieve good results and guarantee the performance, traditional exact algorithms and heuristic methods require large amount of expert effort to design specific search strategies for different types of problems or situations. In recent years, artificial intelligence, especially deep reinforcement learning (DRL), has received intensive attention and has achieved surprising good results in many fields, e.g., atari games \cite{mnih2013playing}, Go \cite{silver2016mastering}. Further attempts for solving NP-hard problems are also appeared, e.g., travel sales man problem (TSP) \cite{bello2016neural}, vehicle routing problem (VRP) \cite{nazari2018deep}.

%In addition, DRL method has shown huge potential to solve combinatorial optimization problems \cite{vinyals2015pointer,bello2016neural}. Previous DRL-based method that attacks this new type of 3D BPP \cite{Hu2017Solving} relies heavily on the output of the heuristic algorithm because the network just produces the sequence of packing items. 

Combinational optimization problems are usually to minimize or maximize an objective function under a given set of constraints. To transfer the concept to learning based algorithm, the objective function can be set as the reward of DRL framework. In our 3D BPP discussed in this paper, the smaller the objective, the better. To minimize the objective (i.e. the surface area), a natural way is to decompose the problem into three interdependent decisions \cite{gonccalves2013biased,li2014genetic}: 1) decide the sequence to place these items; 2) decide the place orientation of the selected item; 3) and decide the spatial location (free space). These three decisions can be considered as learning tasks, however, in our proposed method, we concentrated on the first two tasks. Regardless of free space, the sequence of packing the items into the stack will influence the orientations of each item and vice versa, so the two tasks are correlated. Meanwhile, with $n$ items, the choice of orientations is $6^n$ and the choice of sequence is $n!$, so the two tasks are unbalanced. Inspired by multi-task learning, %we overcome the limitations of simply outputting the placement sequence of items by adopting a new type of training mode named
we adopt a new type of training mode named 
Selected Learning (SL) to relief the correlation and imbalance mentioned above. In Selected Learning, we prefer to select one kind of the loss function at each batch than to train the loss of all tasks at once. Moreover, through keeping track of the best solution sampled during the search, we find that combining Selected Learning with sampling at inference time works best in practice.

In this paper, we present a neural model that achieves state-of-the-art results on the proposed Large-scale 3D Packing Problem Dataset (L3DPD) and 
quantitative experiments are designed and conducted to demonstrate effectiveness of this method. The contributions of this paper are summarized below.
\begin{itemize}	
	\item This is a successful attempt to define and solve the real-world problem of New Type 3D Bin Packing (Section \ref{sec:problem}).
		We collect and will open source a large scale 3D Bin Packing order dataset (Section \ref{sec:data}).
	\item We use an intra-attention mechanism to tackle the sequential decision problems during the optimization, which considers items that have already been generated by the decoder.  
	\item We propose a multi-task framework based on Selected Learning, which can significantly relief the correlation and imbalance among tasks. Based on this framework, packing sequence and orientations can be conducted at the same time. 
	\item By sampling at inference time, we achieves $6.21\%$, $7.80\%$, $8.55\%$ improvement than the greedily heuristic algorithm designed for the new type 3D BPP for BIN8, BIN10 and BIN12.
\end{itemize}

%The rest of the paper is organized as follows:
%\secref{sec:problem} provides the formal definition of new type 3D bin packing problem in our study.
%\secref{sec:data} introduces how we collect our L3DBPD dataset.
%\secref{sec:model} describes the proposed multi-task selected learning architecture.
%Then \secref{sec:implementation} gives the implementation details of our model for reproducibility.
%\secref{sec:eval} presents the experimental results and analysis on L3DBPD data.
%We conduct the detailed comparison with baseline models %\lu{baseline models contains rl ?} 
%including a well-designed algorithm NBPH and a state of art method BRKGA in \cite{gonccalves2013biased} which tackles the fixed-sized 3D BPP.
%\secref{sec:related} provides a literature survey of most related previous work.
%Finally \secref{sec:conclusion} concludes and points out some future research directions.
