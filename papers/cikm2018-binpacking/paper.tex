\documentclass[sigconf]{acmart}

\usepackage{booktabs} % For formal tables

% Copyright
\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

%Conference
\acmConference[CIKM'18]{The 2018 Conference on Information and Knowledge Management}{October 2018}{Lingotto, Turin, Italy} 
\acmYear{2018}

\usepackage{times}
\usepackage{latexsym}
\usepackage{graphicx}
\usepackage{CJKutf8}
\usepackage{epsfig}
\usepackage{algorithm, algpseudocode}
\usepackage{algpseudocode}
\usepackage{booktabs}
\usepackage{multirow}

\usepackage{makecell}
\usepackage{CJKutf8}
\usepackage{epsfig}
\usepackage{algorithm, algpseudocode}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{color}
\usepackage{subfigure}
\usepackage{url}
\usepackage{mathrsfs}
\usepackage{amsmath}

\usepackage{url}


\newcommand\BibTeX{B{\sc ib}\TeX}
\newcommand{\secref}[1]{Section \ref{#1}}
\newcommand{\figref}[1]{Figure \ref{#1}}
\newcommand{\eqnref}[1]{Eq. (\ref{#1})}
\newcommand{\exref}[1]{Example \ref{#1}}
\newcommand{\algoref}[1]{Algorithm \ref{#1}}
\newcommand{\tabref}[1]{Table \ref{#1}}
\newcommand{\bi}[1]{\textbf{\textit{#1}}}

\newcommand{\yu}[1]{{\bf \color{orange} [[Yu says ``#1'']]}}
\newcommand{\lu}[1]{{\bf \color{blue} [[Lu says ``#1'']]}}
\newcommand{\kz}[1]{{\bf \color{red} [[Kenny says ``#1'']]}}

\newcommand{\lstm}{\operatornamewithlimits{LSTM}}
\newcommand{\bilstm}{\operatornamewithlimits{BiLSTM}}
\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\seg}{\operatornamewithlimits{seg\_tag}}
\newcommand{\ner}{\operatornamewithlimits{ne\_tag}}
\newcommand{\slot}{\operatornamewithlimits{slot\_fill}}
\newcommand{\batch}{\operatornamewithlimits{Batch}}

\begin{document}
\title{A Multi-task Selected Learning Approach for Solving \\New Type 3D Bin Packing Problem}

%\subtitle{Extended Abstract}



\author{
	Haoyuan Hu$ ^1$ \footnotemark[1], 
	Lu Duan$^2$ \footnotemark[1],
	Yu Gong$^3$,
	Kenny Q. Zhu$^4$ \footnotemark[2] \\
	Xiaodong Zhang$^5$,
	Jiangwen Wei$^6$,
	Yinghui Xu$^7$
}
\affiliation{
  	\institution{$^1$ $^2$ $^5$ $^6$ $^7$ Artificial Intelligence Department, Zhejiang Cainiao Supply Chain Management Co., Ltd}
	\institution{$^3$ Search Algorithm Team, Alibaba Group}
	\institution{$^4$ Shanghai Jiao Tong University}
}
\email{{haoyuan.huhy, duanlu.dl}@cainiao.com, gongyu.gy@alibaba-inc.com, kzhu@cs.sjtu.edu.cn}
\email{yuhui.zxd@cainiao.com, jiangwen.wjw@alibaba-inc.com, renji.xyh@taobao.com}


%\author{John Smith}
%\affiliation{\institution{The Th{\o}rv{\"a}ld Group}}
%\email{jsmith@affiliation.org}

%\author{Julius P.~Kumquat}
%\affiliation{\institution{The Kumquat Consortium}}
%\email{jpkumquat@consortium.net}

% The default list of authors is too long for headers.
\renewcommand{\shortauthors}{H. Hu et al.}
\renewcommand{\authors}{Haoyuan Hu, Lu Duan, Yu Gong, Kenny Q. Zhu, Xiaodong Zhang, Jiangwen Wei, Yinghui Xu}
\renewcommand{\shorttitle}{MTSL for New Type 3D BPP}

\begin{abstract}
	This paper studies a novel real-world application: a new type of 3D bin packing problem (BPP), in which a number of cuboid-shaped items must be put into a bin one by one orthogonally. The objective is to find a way to place these items such that the surface area of the bin is minimized. 
This problem is based on the fact that there is no fixed-sized bin in 
many real business scenarios and the cost of a bin is proportional to 
its surface area. Based on previous research on 3D BPP, 
the surface area is determined by the sequence, spatial locations and 
orientations of items. It is a new NP-hard combinatorial optimization 
problem on unfixed-sized bin packing, for which we propose a multi-task 
framework based on Selected Learning, generating the sequence and 
orientations of items packed into the bin simultaneously. 
During training steps, Selected Learning chooses one of loss functions 
derived from deep reinforcement learning and supervised learning corresponding 
to the training procedure. We produce large scale 3D Bin Packing order data 
set from Cainiao Supply Chain for studying bin packing problems. 
Comprehensive experiments on this data set are conducted to validate the 
effectiveness of our research in reducing packing materials by 
comparisons with other baseline methods. %deployed on operational system of Cainiao Supply Chain. 
Numerical results also demonstrate that the method proposed 
significantly outperforms the well-designed heuristic baselines by 
a substantial gain of $7.52\%$.
	
\end{abstract}

%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below.
%


%\ccsdesc[500]{Computer systems organization~Embedded systems}
%\ccsdesc[300]{Computer systems organization~Redundancy}
%\ccsdesc{Computer systems organization~Robotics}
%\ccsdesc[100]{Networks~Network reliability}


%\keywords{ACM proceedings, \LaTeX, text tagging}


\maketitle

\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\footnotetext[1]{Equally contribution.}
\footnotetext[2]{Corresponding author.}
\renewcommand{\thefootnote}{\arabic{footnote}}

\begin{CJK}{UTF8}{gbsn}
	
	\input{intro}
	
	\input{problem}
	
	\input{data}
	
	\input{approach}
	
	\input{experiment}
	
	\input{related}
	
	\input{conclusion}
	
\end{CJK}

\bibliographystyle{ACM-Reference-Format}
\bibliography{ref}

\appendix
\section{NP-hardness of New Type of 3D BPP}
\label{np-hard}
\begin{lemma} 
	The new type of 3D BPP proposed in this paper is NP-hard.
\end{lemma}
\textbf{Proof}: 
First of all, we will prove the new type of 2D BPP is NP-hard. To show it is NP-hard, we will give a reduction of 1D Bin Packing Problem. 

Given a one-dimensional bin packing problem, it consists of $n$ items with integer size $w_1,\cdots,w_n$ and bins with integer capacity $W$. The objective is to minimize the number of bins used to pack all items.

To convert it into new type of 2D BPP, we assume that there are $n$ items with length $w_i$ and width $1/(n \cdot max({w_i}))$. Besides there is another item with length $W$ and width $W \cdot n  \cdot max(w_i)$, which is denoted as \emph{Base Item}. The new type of 2D BPP problem is to find the bin with least surface area to pack all the generated $n+1$ items.

Without loss of generality, we assume the \emph{Base Item} is on the left-bottom of the bin. Adding one item on the right side of the \emph{Base Item} yields the total surface area is increased at least $ (W \cdot n \cdot max(x_i) )/( n \cdot max(w_i)) = W$. At the same time, even if all the items are added on the upper side of the \emph{Base Item}, the total increased area is at most $W$. Thus, all the items will be put on the upper side of the \emph{Base Item}. 

Next, we will prove the orientation of the item will not be changed. If reversing one item with width and length, the increased area is at least $W \cdot min(w_i)$ for this item. However, the increased area is at most $W$ for all items if no item is reversed. 

If we can find out a bin with least surface area to pack this $n+1$ items, we find out the least number of bins of capacity $W$ that can contain $n$ items of size $w_1, \cdots, w_n$. Therefore, if we can solve the new type of 2D BPP in polynomial time, the one-dimensional bin packing problem can be solved in polynomial time, which completes the proof that this new type of 2D BPP is NP-hard unless $P = NP$.

For the new type of 3D bin packing problem, we will add height $1/(n \cdot max({w_i}))^2$ for each item in the 2D case, which will ensure no item will be added on the height side. Proof is the same as the 2D case.

\section{New 3D Bin Packing Heuristic Algorithm}
\label{NBPH}
New 3D bin packing heuristic algorithm (NBPH) is based on idea of choosing the item, orientation and free space according to least waste space criteria, which aims to obtain least surface area at each step. The detailed \textbf{algorithm NBPH} is as Algorithm \ref{3D bin packing heuristic algorithm}:

\begin{algorithm}[!htb]                  % enter the algorithm environment
	\caption{New 3D Bin Packing Heuristic Algorithm. }       
	\label{3D bin packing heuristic algorithm} 
	\begin{algorithmic}[1]
		\State Denote the set of $n$ items as I. Each item is of length $l_i$, height $h_i$ and width $w_i$.
		\State Initialize a sufficiently large bin(B) with length $L$, width $W$, height $H$ (We could set $L=W = H = \sum_{i=1}^n max(l_i,h_i,w_i)$).
		\State Initialize the set of remaining items $\hat{I} = I$ and the set of free spaces as $ES = \emptyset$.
		\For {\emph{t = 1 to n}}
		\If{$t = 1$}
		\State  Select an item $i$ with largest surface area. 
		\State Put the item into the bin and generate 3 free spaces $ES1$. 
		\State Update $ES = ES1$.
		\State Update $\hat{I}  \leftarrow  \hat{I} \setminus i$
		\Else
		\State Select a item $i$ from $\hat{I}$ according to (Algorithm \ref{Least Waste Space Heuristic}). 
		\State Update $\hat{I}  \leftarrow  \hat{I} \setminus i$.
		\State Select an free space $f_i$ from $ES$ and decide the orientation $o_i$ according to Algorithm \ref{Least surface Area Heuristic}. 
		\State Update $ES  \leftarrow ES  \bigcup ES1  \setminus ES2$.
		\EndIf      
		\EndFor
		\State Return the surface area of the bin that could pack all items.
	\end{algorithmic}
\end{algorithm}

\begin{algorithm}[!htb]                 % enter the algorithm environment
	\caption{Least Surface Area Heuristic for Picking Free Space and Orientation. }       
	\label{Least surface Area Heuristic} 
	\begin{algorithmic}[1]
		\State Denote the set of free space as $ES$, the set of orientations as $\bi{o}$. 
		\State Initialize the least surface area for item $i$ as $LSA_i$. $LSA_i$ is large enough. 
		\State Initialize best free space $\hat{s}_{i} =null$, best orientation as $\hat{o}_i = null$.
		\For{each free space $f \in ES$}
		\For{each orientation $o \in \bi{o}$}
		\State Calculate the surface area $SA_{i,f,o}$ after putting item $i$ in free space $f$ with orientation $o$.
		\If{$SA_{i,f,o}  < LSA_i$}
		\State Update $\hat{f}_{i} =f$. 
		\State Update $\hat{o}_i = o$.
		\State Update $LSA_i  \leftarrow SA_{i,f,o}  $.
		\ElsIf{$SA_{i,f,o} =LSA_i$ (Apply tie-breaking rule)} 
		\State Set $l_f, w_f, h_f$ the length, width, height of free space $f$ 
		\State Set $l_i, w_i, h_i$ the length, width, height of item $i$ with orientation $o$       
		\State  Set $rest1 = min(l_f-l_i, w_f-w_i, h_f-h_i)$. 
		\State  Set $rest2 = min(l_{\hat{f}_{i}}-l_i, w_{\hat{f}_{i}}-w_i, h_{\hat{f}_{i}}-h_i)$ 
		\If {$rest1 < rest2$}
		\State Update $\hat{f}_{i} =f$.
		\State Update $\hat{o}_i = o$.
		\EndIf	
		\EndIf 
		\EndFor
		\EndFor
		\State  Update $ES  \leftarrow ES  \bigcup ES1  \setminus ES2$.
		\State Return $\hat{f}_{i}, \hat{o}_i$ for item $i$ and $ES$.
	\end{algorithmic}
\end{algorithm}

\begin{algorithm}[!htb]                  % enter the algorithm environment
	\caption{Least Surface Area Heuristic for Picking Item. }       
	\label{Least Waste Space Heuristic} 
	\begin{algorithmic}[1]
		\State Denote the set of remaining items as $\hat{I}$.
		\State Denote the surface area of item $i$ as $SA_i$.
		\State Initialize the best item $\hat{i} =null$. 
		\State Initialize the Least surface area as $LSA= {(max(l_i,w_i,h_i) \cdot n)}^3$.
		\For {\emph{each item $i \in \hat{I}$ }}
		\State Calculate the surface area $SA$ after packing item $i$ according to $\hat{f}_{i}, \hat{o}_i$ (which is determined by Algorithm \ref{Least surface Area Heuristic}). 
		\State Denote the least waste space of item $LSA_i = SA-SA_i$.
		\If{$LSA_i < LSA$}
		\State  Update $LSA = LSA_i $.
		\State  Update $\hat{i} = i$.
		\EndIf
		\EndFor
		\State Return item $i$.
	\end{algorithmic}
\end{algorithm}

\begin{algorithm}[!htb]                 % enter the algorithm environment
	\caption{Least Surface Area Heuristic for Picking Free Space}       
	\label{Least surface Area Heuristic(1)} 
	\begin{algorithmic}[1]
		\State Input: Item $t$ and Orientation $o_t$.
		\If {t=1}
		\State Initialize the set of free space $ES = {(L,H,W)}$, $(L,H,W)$ represents a sufficiently large bin.
		\Else 
		\State $ES$ is retrieved from the latest step
		\EndIf 
		\State Initialize the least surface area for item $t$ as $LSA_t$. $LSA_t$ is a large enough number.
		\State Initialize best free space $\hat{f}_{t} =null$.
		\For{each free space $f \in ES$}
		\State Calculate the surface area $SA_{t,f,o_t}$ after putting item $t$ in free space $f$ with orientation $o_t$.
		\If{$SA_{t,f,o_t} < LSA_t$}
		\State  Update $\hat{f}_{t} =f$ and $LSA_t \leftarrow SA_{t,f,o_t}$.
		\ElsIf{$SA_{t,f,o_t} =LSA_t$ (Apply tie-breaking rule)} 
		\State Set $l_f, w_f, h_f$ the length, width, height of free space $f$ 
		\State Set $l_t, w_t, h_t$ the length, width, height of item $t$ with orientation $o_t$       
		\State  Set $rest1 = min(l_f-l_t, w_f-w_t, h_f-h_t)$. 
		\State  Set $rest2 = min(l_{\hat{f}_{t}}-l_t, w_{\hat{f}_{t}}-w_t, h_{\hat{f}_{t}}-h_t)$ 
		\If {$rest1 < rest2$}
		\State Update $\hat{f}_{t} =f$.
		\EndIf	
		\EndIf 
		\EndFor
		\State Generate new free spaces($ES1$) and delete those that are intersected and overlapped($ES2$).
		\State Update $ES  \leftarrow ES  \bigcup ES1  \setminus ES2$.
		\State Return $\hat{f}_{t}$ for item $t$ and its orientation $o_t$ and free space set $ES$.
	\end{algorithmic}
\end{algorithm}


%\textbf{Least Waste Space Heuristic:}





%The heuristic algorithm uses both least surface area heuristic I and least waste space heuristic while our SL method only uses least surface area heuristic II.




\end{document}
