\section{E-commerce Concept Net} 
\label{sec:ecn}

%A user need is a motive that prompts a user to buy a product or service.
User needs in e-commerce, are not formally defined previously.
Hierarchical categories and browse nodes \footnote{\url{https://www.browsenodes.com/}} are ways of managing billions of items in e-commerce platforms
and are usually used to represent user needs or interests \cite{zhou2018deep, feng2019deep}.
However, user needs are far broader than categories or browse nodes. Imaging a user who is planning an outdoor barbecue, or who is concerned with how to get rid of a raccoon in his garden.
They have a situation or problem but do not know what products can help.
Therefore, tree-like structures such as hierarchical categories and browse nodes are not enough to represent those user needs.
%E-commerce concept net, on the other hand, is a graph structure where each node can be expressed by terms from domains including ``Incident'' and ``Function'' and is able to represent various shopping needs.

In our e-commerce concept net \footnote{This section only gives
a brief introduction of the e-commerce concept net, while more details will be 
discussed in a separate paper which will be released in the near future at \url{https://github.com/angrymidiao/concept_net}.},
user needs are conceptualized as various shopping scenarios, also known as ``e-commerce concepts''.
We \textbf{define} a proper concept being a short, fluent and reasonable phrase which naturally represents a set of items from different categories.
In order to cover as many user needs as possible,
a thorough analysis on query logs, product titles and other e-commercial text is conducted.
Based on years of experience in e-commerce,
each concept is expressed using values drawn from $8$ different domains of
an ``e-commerce concept vocabulary'', which is shown in \figref{fig:kg} (b).
%\KZ{I think the concept ontology should be renamed to ``concept vocabulary''. Ontology
%means the knowledge graph itself. So this naming maybe confusing.}
For example, ``Outdoor Barbecue'' can be written as 
``\textit{Location}: outdoor, \textit{Incident}: barbecue'', 
and ``Breakfast for Pregnancy'' can be written as ``\textit{Object}: pregnant women, \textit{Cate/Brand}: breakfast''.

%We use phrase mining algorithms such as AutoPhrase\cite{shang2018automated} to mine possible concept phrases from e-commerce text including search query, item title, reviews and shopping guidance written by merchants. Then, a binary classifier is used to filter out illegal concepts.
To form the complete e-commerce concept net,
concepts are related to their representative items, 
categories, brands respectively, mainly adopting the idea of semantic matching \cite{huang2013learning, shen2014learning}.
%\KZ{What do you mean by ``other concepts''? These are not from the concept
%ontology right? A bit confusing here.} 
It should be noticed that there is a hierarchy within each domain. For example, ``Shanghai'' is a city in ``China'' in the domain of \textit{Location} and ``pregnancy'' is a special stage of a ``woman'' in the domain of \textit{Object}.  Vocabulary terms at different levels can be combined and result in different concepts.
Accordingly, those concepts are naturally related to form a hierarchy as well.
Besides the vocabularies to describe concepts, there are constraints to each concept. 
The aspects of concept \textit{schema} include
 \textit{gender}, \textit{life stage} \footnote{Life stage is divided into: pregnancy, infant, kindergarten, primary school, middle school and high school in Taobao.}, etc.
which actually corresponds to user profile.
For example, the schema of ``Breakfast for Pregnancy'' will be ``\textit{gender}: female, \textit{life stage}: pregnancy'', which indicates the group of users who are most likely to need this concept.

\begin{table}[th]
	\centering
	\small
	\begin{tabular}{|l|r|r|r|r|}
		\hline
		\multirow{4}{*}{Ontology Vocab.} 
		&\# Time &\# Location &\# Object &\# Func.  \\
		\cline{2-5}
		& 127 & 7,052 & 247 & 3,693 \\
		\cline{2-5}
		&\# Inci. & \# Cate/Bra. & \# Style &\# IP  \\
		\cline{2-5}
		& 9,884 & 44,860 & 1,182 & 21,230 \\
		\hline
		\# Concepts (Raw) & \multicolumn{1}{c|}{35,211} &
		\multicolumn{2}{c|}{\# Concepts (Online)} & \multicolumn{1}{c|}{7,461} \\ 
		\hline
		\# Items & \multicolumn{1}{c|}{1 billion} &
		\multicolumn{2}{c|}{\# Categories/Brands} & \multicolumn{1}{c|}{19K/5.5M} \\ 
		\hline
		%		\bottomrule
	\end{tabular}
	\caption{Statistics of E-commerce Concept Net.}
	\label{tab:data}
\end{table}


%Crowdsourcing effort is important during the construction of e-commerce concept net, 
%aiming to make sure the overall quality fits the requirements of industry applications. 
%All the concepts and edges generated automatically will be randomly sampled in batches to test accuracy, 
%and only those batches pass the test will be added into the graph.
\tabref{tab:data} shows the statistics of the concept net used in this
paper~\footnote{Preview of concept data can be found at \url{https://github.com/angrymidiao/concept_net}.}.
There are 35,211 concepts in total at current stage, 
among which 7,461 concepts are already deployed in our online recommender system, covering over 90\% categories of Taobao and each concept is related with 10.4 categories on average.

Inspired by the construction of open-domain KGs such as Freebase \cite{bollacker2008freebase} and DBpedia \cite{auer2007dbpedia} which benefit various downstream applications \cite{luo2018knowledge,luo2018cross}, different kinds of KGs in e-commerce are constructed
to describe relations among users, items and item attributes \cite{catherine2017explainable,ai2018learning,gong2019deep}.
One famous example is the ``Product Knowledge Graph'' \footnote{\url{https://blog.aboutamazon.com/innovation/making-search-easier}} of Amazon. Their KG mainly supports semantic search, aiming to help users search for products that fit their need with search queries like ``items for picnic''. The major difference is that they never conceptualize user needs as explicit nodes in KG as we do.
In comparison, our e-commerce concept net introduces a new node to explicitly represent user needs. Besides, it becomes possible to link our e-commerce KG to open-domain KGs through the concept vocabulary, %mentioned in \secref{sec:ecn}
making our concept net even more powerful.

\section{Problem}
\label{sec:problem}

In this section, we formally define the problem of user needs inference.
Let $\bi{U}$, $\bi{V}$ denote the sets of users, items respectively.
The inputs of our problem are as follows:

\noindent
\textbf{1) User behavior on items}. For each $u\in \bi{U}$,  a behavior sequence 
$b= \{b_1, b_2, \cdots, b_n\}$ is a list of behaviors in time order, 
where $b_i$ is the $i^{th}$ behavior and $b_n$ is the latest one. 
Each user behavior contains a user-item interaction, 
detailed as $b_i = <v_i, type_i, time_i>$, where $v_i \in \bi{V}$, 
$type_i$ is the type of behavior, such as click or purchase, and
$time_i$ denotes the specific time of the behavior.

\noindent
\textbf{2) E-commerce concept net}. Concept net $\bi{G}$ consists of massive triples $(h, r, t)$, 
where $h, t\in \bi{E}$, $r\in \bi{R}$ denote the head, tail and relation.
$\bi{E}$ and $\bi{R}$ are entities and relations in the concept net.
While most items in $\bi{V}$ can be linked to entities in $\bi{E}$, 
some items may not, since the item pool in e-commerce platforms changes frequently. 
The set of all concepts in $\bi{G}$ is denoted as $\bi{C}$.

\noindent
\textbf{3) Side information}. 
For each user $u\in \bi{U}$, we have corresponding profile information $h$, 
such as \textit{gender}, \textit{kid's life stage} and long-term preferred categories, etc.
For each concept $c\in \bi{C}$, we have its schema $s$ introduced in \secref{sec:ecn};


Given above inputs, the goal of user needs inference is to predict potential need in concept $c$ for each user $u$. We aim to learn a prediction function $\hat y_{uc} = \bi{F}(u, c; \theta)$, denoting the probability concept $c$ is needed by user $u$, and $\theta$ is the model parameters.

