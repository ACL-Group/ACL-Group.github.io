\documentclass{article}

\begin{document}


We define a Dataset with three parameters $( Q_{distinct} ,R, N_{long})$

where $Q_{distinct}$ represents the number of distinct qids , R represents the record number, 
and $N_{long}$ represents the number of records whose length $\geq$ $l_{min}$

We consider one iteration,
$Time =\frac{Q_{distinct}}{B} \cdot Handle_{short}+ N\cdot Handle_{long}$

According to our algorithm, the worst time complexity of $Handle_{short}$  is $B\cdot R$ and $Handle_{long}$ is N.
It is easy to be observed that once fixing a short qid, the worst case is to scan the whole dataset .And when we  fix
a long one , the worst case is that all of the long qids are the same, indicating the number of intersection operations
are N.

so $Time_{max} =Q_{distinct}\cdot R+ N^2$\label{timecost}






Lemma:  The worst case is square scale-up with R and the best case is linear scale-up with R

We consider Dataset ($Q_{1}$,R1,N1) and Dataset ($Q_{2}$,R2,N2)
According to the equation \ref{timecost}

 $Time_{1} =Q_{1}\cdot R+ N_{1}^2$
 
  $Time_{2} =Q_{2}\cdot R+ N_{2}^2$
  
Now we union Dataset ($Q_{1}$,R1,N1) and Dataset ($Q_{2}$,R2,N2) and get a new Dataset ($Q_{3}$,R3,N3)
It is easy to observe that  max$\{Q_{1},Q_{2}\}   \leq Q_{3} \leq Q_{1}+Q_{2}$ and N3=N1+N2

As a result,

$Time_{max} =(Q_{1}+Q_{2})\cdot (R1+R2)+ (N_{1}+N_{2})^2$


$Time_{min} =max\{Q_{1},Q_{2}\}\cdot (R1+R2)+max\{N_{1},N_{2}\}^2$

If we suppose the distribution of ($Q_{1}$,R1,N1) and  ($Q_{2}$,R2,N2) are similar, we can claim that  $Q_{distinct}=K\cdot R$ 
and $N=M\cdot R$
here K and M are constants. Since the distribution of the column and the item of dataset1 are similar with  dataset2, the number of distinct qids is linear with R. It is a reasonable assumption that the distribution of the dataset should remain the same no matter how many records are recorded.

Based on this assumption, we have $Time_{max} =K\cdot(R1+R2)^2+ M^2\cdot(R_{1}+R_{2})^2$ and 



$Time_{min} =max\{R_{1},R_{2}\}\cdot (R1+R2)+max\{N_{1},N_{2}\}^2$

Since the data distribution are similar , if we assume R1 is larger than R2, N1 should larger than N2,too.
So we suppose R1 $\>$ R2

$Time_{min} = (R1^2+R2\cdot R1)+M^2\cdot R1^2$

Therefore, the time complexity is linear scale-up if it is the best case but square scale-up it is the worst case.























\end{document}

