%\subsection{CTMP: A Clustering-based Transfer Model }
We introduce our novel \textbf{C}lustering-based \textbf{T}ransfer \textbf{M}odel for \textbf{P}rediction  (CTMP), which first clusters links in both source and target areas based on their spatial features and then do time series based prediction for the target links based on neighboring source links with historical data.

\subsection{Intuition Behind the CTMP}
Our intuition behind CTMP is that given a link in target areas with spatial features, we can first find the most similar links in source areas and then leverage the source data to predict the speed of links in target areas.

The assumption here is that links with similar spatial features should also share similar traffic patterns.
However, simply clustering road links based on spatial features performs not very well in practice, because not all the features are equally important and the importances cannot be obtained in such an unsupervised way.
Therefore, we incorporate a regularization term in the distance metric for feature reduction and selection.\footnote{CTMP model can be seen as a combination of clustering and Nadaraya-Watson kernel regression.}

\subsection{Clustering with Regularized Distance Metric}
%\textit{Notations:} a prediction query instance about a link $l$ at the time $t$ is denoted as $(l,t)$; 
%the spatial feature vector for $l$ is denoted as  $s_l$, and the temporal feature vector of the time $t$ being predicted on the link $l$ is denoted as  $t_l$.
%The ground truth of the speed is denoted as $v_l[t]$.
We use the $s_i$ and $s_j$ to denote two spatial feature vectors of any two links $i$ and $j$ respectively.
We capture the distance between the two feature vectors by computing $\text{s\_dis}(i,j) = 1-\cos(s_i,s_j)$.
To regularize the time series similarities between two links, we add a regularization term $\text{t\_dis}(i,j)$, which has multiple options.
A desirable option is the DTW \cite{} similarities between the weekly HAM traffic speed series of the two links.
Thus, the total distance between two links can be regarded as follows, where $\lambda$ is a hyper parameter to control the weight of temporal distance:
$\text{dis}(i,j) =  \text{s\_dis}(i,j) + \lambda \text{t\_dis}(i,j) $.

With such supervision in the source area data,
we can use K-means as our clustering algorithm.
For each query instance $(l,t)$\footnote{The link $l$ has no historical data in the transfer scenario.}, we first find the closest $k$ neighboring source links with historical data $\{l_1,...l_k\}$.
We compute all the distances between them and the target link $l$ respectively, and obtain the set of spatial feature distances $\{\text{dis}(l,l_1),...,\text{dis}(l,l_k)\}$.
Also, we can get the predicted typical traffic speed for such neighboring links based on existing time-series models  at the time $t$: $\{y(l_1,t),...,y(l_k,t)\}$.
Finally, we can compute the predicted result for the query instance $(l,t)$ is:
$$ y(l,t) = \sum_{i=1}^k \left( \frac{\text{dis}(l,l_i)}{\sum_{j=1}^k \text{dis}(l,l_j)} 
y(l_i,t)
\right)$$ 

%\BL{add a figure to illustrate this novel model}